{
  "repository": {
    "name": "repo-explainer",
    "path": "/Users/saadkhalid/Projects/repo-explainer",
    "primary_language": "Python",
    "languages": ["Python"],
    "entry_points": ["src/repo_explainer/cli.py"]
  },
  "components": [
    {
      "component_id": "cli",
      "name": "CLI Entry Point",
      "type": "module",
      "file_path": "src/repo_explainer/cli.py",
      "line_range": {"start": 1, "end": 320},
      "description": "Command-line interface using Typer. Handles user input, argument parsing, and orchestrates the analysis pipeline.",
      "responsibilities": [
        "Parse command-line arguments",
        "Configure global settings",
        "Orchestrate analysis workflow",
        "Provide visual feedback to users"
      ],
      "key_functions": [
        {
          "name": "analyze",
          "file_path": "src/repo_explainer/cli.py",
          "line_range": {"start": 43, "end": 283},
          "signature": "def analyze(repo_path_or_url: str, depth: str, output: Optional[Path], force_clone: bool, verbose: bool) -> None",
          "purpose": "Analyze a repository and generate documentation"
        }
      ],
      "dependencies": {
        "internal": ["repository-loader", "opencode-service", "output-manager"],
        "external": ["typer", "rich"]
      },
      "interfaces": [
        {
          "name": "CLI Commands",
          "type": "function",
          "endpoints": ["analyze", "update"]
        }
      ]
    },
    {
      "component_id": "repository-loader",
      "name": "Repository Loader",
      "type": "module",
      "file_path": "src/repo_explainer/repository_loader.py",
      "description": "Manages repository access by resolving local paths and cloning remote Git repositories to a temporary workspace.",
      "responsibilities": [
        "Resolve local file paths",
        "Detect and parse Git URLs",
        "Clone remote repositories",
        "Manage repository caching"
      ],
      "dependencies": {
        "internal": [],
        "external": ["GitPython", "pathlib"]
      }
    },
    {
      "component_id": "opencode-service",
      "name": "OpenCode Service",
      "type": "module",
      "file_path": "src/repo_explainer/opencode_service.py",
      "line_range": {"start": 1, "end": 240},
      "description": "Interface to OpenCode AI agent. Constructs prompts, executes opencode binary as subprocess, and parses JSON output streams.",
      "responsibilities": [
        "Construct context-aware prompts",
        "Execute opencode binary",
        "Stream and parse output",
        "Extract session metadata"
      ],
      "key_functions": [
        {
          "name": "analyze_architecture",
          "file_path": "src/repo_explainer/opencode_service.py",
          "line_range": {"start": 150, "end": 167},
          "signature": "def analyze_architecture(self, event_callback: Callable[[dict], None] | None = None) -> OpenCodeResult",
          "purpose": "Run comprehensive architecture analysis"
        }
      ],
      "dependencies": {
        "internal": ["config", "prompts"],
        "external": ["subprocess", "json"]
      }
    },
    {
      "component_id": "output-manager",
      "name": "Output Manager",
      "type": "module",
      "file_path": "src/repo_explainer/output_manager.py",
      "description": "Handles data persistence by saving artifacts, logs, and metadata to the output directory.",
      "dependencies": {
        "internal": ["doc-composer"],
        "external": ["pathlib", "json"]
      }
    },
    {
      "component_id": "doc-composer",
      "name": "Document Composer",
      "type": "module",
      "file_path": "src/repo_explainer/doc_composer.py",
      "line_range": {"start": 1, "end": 1140},
      "description": "Post-processes raw artifacts into coherent documentation. Converts Mermaid diagrams to SVG and aggregates markdown files into a navigable structure.",
      "responsibilities": [
        "Render Mermaid diagrams to SVG",
        "Generate per-component documentation",
        "Create dependency documentation",
        "Generate API documentation",
        "Create navigation pages"
      ],
      "dependencies": {
        "internal": [],
        "external": ["subprocess", "re", "json"]
      }
    }
  ]
}
